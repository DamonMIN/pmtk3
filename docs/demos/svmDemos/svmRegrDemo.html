
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>svmRegrDemo</title><meta name="generator" content="MATLAB 7.9"><meta name="date" content="2010-02-25"><meta name="m-file" content="svmRegrDemo"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><pre class="codeinput">nVars = 1;
nInstances = 50;
setSeed(0);

<span class="comment">%[X,y] = makeData('regressionNonlinear',nInstances,nVars);</span>
<span class="comment">% sinc function</span>
N = 100;
noise		= 0.1;
x	= 10*[-1:2/(N-1):1]';
ytrue	= sin(abs(x))./abs(x);
y	= ytrue + noise*randn(N,1);
X = x;


lambda = 1e-1;
rbfScale = 0.3;
Ktrain =  rbfKernel(X, X, rbfScale);
<span class="comment">%Xtest = [-5:.05:5]';</span>
Xtest = [-10:.1:10]';
Ktest = rbfKernel(Xtest, X, rbfScale);

<span class="keyword">for</span> trial=1:3
   <span class="keyword">switch</span> trial
      <span class="keyword">case</span> 1,
         epsilon = 0.3;
         [w, bias, SV] = svmRegrFit(Ktrain, y, epsilon, 1/lambda);
         lossStr = sprintf(<span class="string">'SVM(%s=%3.1f)'</span>,  <span class="string">'\epsilon'</span>, epsilon);
         fname = <span class="string">'SVM3'</span>;
      <span class="keyword">case</span> 2,
         epsilon = 0.1;
         [w, bias, SV] = svmRegrFit(Ktrain, y, epsilon, 1/lambda);
         lossStr = sprintf(<span class="string">'SVM(%s=%3.1f)'</span>, <span class="string">'\epsilon'</span>, epsilon);
         fname = <span class="string">'SVM1'</span>;
      <span class="keyword">case</span> 3,
         model = linregFitL2(Ktrain, y, lambda);
         w = model.w; bias = model.w0;
         lossStr = sprintf(<span class="string">'linreg'</span>);
         fname = <span class="string">'linreg'</span>;
   <span class="keyword">end</span>
   yhat = Ktest*w + bias;


   <span class="comment">% Plot results</span>
   figure; hold <span class="string">on</span>;
   plot(X,y,<span class="string">'*'</span>, <span class="string">'markersize'</span>, 8, <span class="string">'linewidth'</span>, 2);
   h=plot(Xtest(:,1),yhat,<span class="string">'g-'</span>);
   set(h,<span class="string">'LineWidth'</span>,3);
   <span class="keyword">if</span> strcmp(lossStr(1:3), <span class="string">'SVM'</span>)
      <span class="comment">%SV = abs(Krbf*uRBF - y) &gt;= changePoint;</span>
      plot(X(SV),y(SV),<span class="string">'o'</span>,<span class="string">'color'</span>,<span class="string">'r'</span>, <span class="string">'markersize'</span>, 12, <span class="string">'linewidth'</span>, 2);
      plot(Xtest(:,1),yhat+epsilon,<span class="string">'c--'</span>, <span class="string">'linewidth'</span>, 2);
      plot(Xtest(:,1),yhat-epsilon,<span class="string">'c--'</span>, <span class="string">'linewidth'</span>, 2);
      legend({<span class="string">'Data'</span>,<span class="string">'prediction'</span>,<span class="string">'Support Vectors'</span>,<span class="string">'Eps-Tube'</span>});
   <span class="keyword">end</span>
   title(sprintf(<span class="string">'%s'</span>, lossStr))
   printPmtkFigure(sprintf(<span class="string">'svmRegrDemoData%s'</span>, fname))

   figure; stem(w)
   title(sprintf(<span class="string">'weights for %s'</span>, lossStr))
   axis_pct
   printPmtkFigure(sprintf(<span class="string">'svmRegrDemoStem%s'</span>, fname))
<span class="keyword">end</span>
placeFigures
</pre><pre class="codeoutput">Warning: Large-scale algorithm does not
currently solve this problem formulation,
using medium-scale algorithm instead. 
Maximum number of iterations exceeded; increase options.MaxIter.
To continue solving the problem with the current solution as the
starting point, set x0 = x before calling quadprog.
Warning: Large-scale algorithm does not
currently solve this problem formulation,
using medium-scale algorithm instead. 
Maximum number of iterations exceeded; increase options.MaxIter.
To continue solving the problem with the current solution as the
starting point, set x0 = x before calling quadprog.
ans =
     1     4     7
     2     5    -1
     3     6    -1
</pre><img vspace="5" hspace="5" src="svmRegrDemo_01.png" alt=""> <img vspace="5" hspace="5" src="svmRegrDemo_02.png" alt=""> <img vspace="5" hspace="5" src="svmRegrDemo_03.png" alt=""> <img vspace="5" hspace="5" src="svmRegrDemo_04.png" alt=""> <img vspace="5" hspace="5" src="svmRegrDemo_05.png" alt=""> <img vspace="5" hspace="5" src="svmRegrDemo_06.png" alt=""> <img vspace="5" hspace="5" src="svmRegrDemo_07.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.9<br></p></div><!--
##### SOURCE BEGIN #####
nVars = 1;
nInstances = 50;
setSeed(0);

%[X,y] = makeData('regressionNonlinear',nInstances,nVars);
% sinc function
N = 100;
noise		= 0.1;
x	= 10*[-1:2/(N-1):1]';
ytrue	= sin(abs(x))./abs(x);
y	= ytrue + noise*randn(N,1);
X = x;


lambda = 1e-1;
rbfScale = 0.3;
Ktrain =  rbfKernel(X, X, rbfScale);
%Xtest = [-5:.05:5]';
Xtest = [-10:.1:10]';
Ktest = rbfKernel(Xtest, X, rbfScale);

for trial=1:3
   switch trial
      case 1,
         epsilon = 0.3;
         [w, bias, SV] = svmRegrFit(Ktrain, y, epsilon, 1/lambda);
         lossStr = sprintf('SVM(%s=%3.1f)',  '\epsilon', epsilon);
         fname = 'SVM3';
      case 2,
         epsilon = 0.1;
         [w, bias, SV] = svmRegrFit(Ktrain, y, epsilon, 1/lambda);
         lossStr = sprintf('SVM(%s=%3.1f)', '\epsilon', epsilon);
         fname = 'SVM1';
      case 3,
         model = linregFitL2(Ktrain, y, lambda);
         w = model.w; bias = model.w0;
         lossStr = sprintf('linreg');
         fname = 'linreg';
   end
   yhat = Ktest*w + bias;
   
   
   % Plot results
   figure; hold on;
   plot(X,y,'*', 'markersize', 8, 'linewidth', 2);
   h=plot(Xtest(:,1),yhat,'g-');
   set(h,'LineWidth',3);
   if strcmp(lossStr(1:3), 'SVM')
      %SV = abs(Krbf*uRBF - y) >= changePoint;
      plot(X(SV),y(SV),'o','color','r', 'markersize', 12, 'linewidth', 2);
      plot(Xtest(:,1),yhat+epsilon,'cREPLACE_WITH_DASH_DASH', 'linewidth', 2);
      plot(Xtest(:,1),yhat-epsilon,'cREPLACE_WITH_DASH_DASH', 'linewidth', 2);
      legend({'Data','prediction','Support Vectors','Eps-Tube'});
   end
   title(sprintf('%s', lossStr))
   printPmtkFigure(sprintf('svmRegrDemoData%s', fname))
   
   figure; stem(w)
   title(sprintf('weights for %s', lossStr))
   axis_pct
   printPmtkFigure(sprintf('svmRegrDemoStem%s', fname))
end
placeFigures


##### SOURCE END #####
--></body></html>