
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>fit a rbf kernel binary logistic regression model to the crabs data</title><meta name="generator" content="MATLAB 7.10"><meta name="date" content="2010-03-23"><meta name="m-file" content="logregKernelCrabsDemo"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h1>fit a rbf kernel binary logistic regression model to the crabs data</h1><pre class="codeinput"><span class="comment">%PMTKslow</span>
load <span class="string">crabs</span>
<span class="comment">% Cross validates over both lambda and 'rbf' Sigma</span>
[LRL2model, lambdaStar, LRmu, LRse] = logregFit(Xtrain, ytrain,<span class="keyword">...</span>
    <span class="string">'kernelFn'</span>, @kernelRbfSigma, <span class="string">'lambda'</span>,logspace(-7,-4,20), <span class="string">'kernelParam'</span>, 8:0.5:10, <span class="string">'doPlot'</span>, true, <span class="string">'regType'</span>, <span class="string">'L1'</span>);
set(gca, <span class="string">'xscale'</span>, <span class="string">'log'</span>)
yhat = logregPredict(LRL2model, Xtest);
lrL1Nerrors = sum(yhat ~= ytest) <span class="comment">%1</span>
<span class="comment">%(see svmCrabsDemo)</span>
</pre><pre class="codeoutput">cross validating over 
  Column 1
   0.000000100000000
   0.000000143844989
   0.000000206913808
   0.000000297635144
   0.000000428133240
   0.000000615848211
   0.000000885866790
   0.000001274274986
   0.000001832980711
   0.000002636650899
   0.000003792690191
   0.000005455594781
   0.000007847599704
   0.000011288378917
   0.000016237767392
   0.000023357214691
   0.000033598182863
   0.000048329302386
   0.000069519279618
   0.000100000000000
   0.000000100000000
   0.000000143844989
   0.000000206913808
   0.000000297635144
   0.000000428133240
   0.000000615848211
   0.000000885866790
   0.000001274274986
   0.000001832980711
   0.000002636650899
   0.000003792690191
   0.000005455594781
   0.000007847599704
   0.000011288378917
   0.000016237767392
   0.000023357214691
   0.000033598182863
   0.000048329302386
   0.000069519279618
   0.000100000000000
   0.000000100000000
   0.000000143844989
   0.000000206913808
   0.000000297635144
   0.000000428133240
   0.000000615848211
   0.000000885866790
   0.000001274274986
   0.000001832980711
   0.000002636650899
   0.000003792690191
   0.000005455594781
   0.000007847599704
   0.000011288378917
   0.000016237767392
   0.000023357214691
   0.000033598182863
   0.000048329302386
   0.000069519279618
   0.000100000000000
   0.000000100000000
   0.000000143844989
   0.000000206913808
   0.000000297635144
   0.000000428133240
   0.000000615848211
   0.000000885866790
   0.000001274274986
   0.000001832980711
   0.000002636650899
   0.000003792690191
   0.000005455594781
   0.000007847599704
   0.000011288378917
   0.000016237767392
   0.000023357214691
   0.000033598182863
   0.000048329302386
   0.000069519279618
   0.000100000000000
   0.000000100000000
   0.000000143844989
   0.000000206913808
   0.000000297635144
   0.000000428133240
   0.000000615848211
   0.000000885866790
   0.000001274274986
   0.000001832980711
   0.000002636650899
   0.000003792690191
   0.000005455594781
   0.000007847599704
   0.000011288378917
   0.000016237767392
   0.000023357214691
   0.000033598182863
   0.000048329302386
   0.000069519279618
   0.000100000000000
  Column 2
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.000000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   8.500000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.000000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
   9.500000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
  10.000000000000000
lrL1Nerrors =
     1
</pre><img vspace="5" hspace="5" src="logregKernelCrabsDemo_01.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.10<br></p></div><!--
##### SOURCE BEGIN #####
%% fit a rbf kernel binary logistic regression model to the crabs data 
%PMTKslow
load crabs
% Cross validates over both lambda and 'rbf' Sigma
[LRL2model, lambdaStar, LRmu, LRse] = logregFit(Xtrain, ytrain,...
    'kernelFn', @kernelRbfSigma, 'lambda',logspace(-7,-4,20), 'kernelParam', 8:0.5:10, 'doPlot', true, 'regType', 'L1');
set(gca, 'xscale', 'log')
yhat = logregPredict(LRL2model, Xtest);
lrL1Nerrors = sum(yhat ~= ytest) %1
%(see svmCrabsDemo)




##### SOURCE END #####
--></body></html>