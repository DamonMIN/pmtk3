
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>fnJoinDemo</title><meta name="generator" content="MATLAB 7.9"><meta name="date" content="2010-02-25"><meta name="m-file" content="fnJoinDemo"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> fnJoinDemo()

nInst = 1000;
nVars = 100;
A = randn(nInst,nVars);
x = rand(nVars,1).*(rand(nVars,1) &gt; .5);
b = A*x + randn;

funObj = @(x)SquaredError(x,A,b);

obj = @(w) sum((A*w-b).^2);
grad = @(w) 2*(A.'*(A*w-b));
funObj2 = @(w) fnJoin(w, obj, grad);

[f1,g1]= funObj(x);
[f2,g2] = funObj2(x);
assert(approxeq(f1,f2))
assert(approxeq(g1,g2))
<span class="keyword">end</span>

<span class="keyword">function</span> [f,g] = SquaredError(w,X,y)
<span class="comment">% w(feature,1)</span>
<span class="comment">% X(instance,feature)</span>
<span class="comment">% y(instance,1</span>
Xw = X*w;
res = Xw-y;
f = sum(res.^2);
g = 2*(X.'*res);
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Could not find an exact
(case-sensitive) match for 'fnJoin'.
C:\pmtk3\util\fnjoin.m is a case-insensitive
match and will be used instead.
You can improve the performance of your code
by using exact
name matches and we therefore recommend that
you update your
usage accordingly. Alternatively, you can
disable this warning using
warning('off','MATLAB:dispatcher:InexactCaseMatch').
This warning will become an error in future
releases. 
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.9<br></p></div><!--
##### SOURCE BEGIN #####
function fnJoinDemo()

nInst = 1000;
nVars = 100;
A = randn(nInst,nVars);
x = rand(nVars,1).*(rand(nVars,1) > .5);
b = A*x + randn;

funObj = @(x)SquaredError(x,A,b);

obj = @(w) sum((A*w-b).^2);
grad = @(w) 2*(A.'*(A*w-b));
funObj2 = @(w) fnJoin(w, obj, grad);

[f1,g1]= funObj(x);
[f2,g2] = funObj2(x);
assert(approxeq(f1,f2))
assert(approxeq(g1,g2))
end

function [f,g] = SquaredError(w,X,y)
% w(feature,1)
% X(instance,feature)
% y(instance,1
Xw = X*w;
res = Xw-y;
f = sum(res.^2);
g = 2*(X.'*res);
end
##### SOURCE END #####
--></body></html>