
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      --><title>mlpRegHmcDemo</title><meta name="generator" content="MATLAB 7.9"><meta name="date" content="2010-02-25"><meta name="m-file" content="mlpRegHmcDemo"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><pre class="codeinput"><span class="comment">% Based on Netlan's DEMHMC3</span>
<span class="comment">% We modified the code so the model is as similar as possible</span>
<span class="comment">% to the one in demev1, so we can compare MCMC with Laplace approx</span>

<span class="comment">% create the data and do EB on the network</span>
mlpRegEvidenceDemo;


<span class="comment">% use the EB hyper-params</span>
alpha = net.alpha;
beta = net.beta;

<span class="comment">% Create and initialize fresh network model.</span>

<span class="comment">% Initialise weights reasonably close to 0</span>
net = mlp(nin, nhidden, nout, <span class="string">'linear'</span>, alpha, beta);
net = mlpinit(net, 10);


<span class="comment">% Set up vector of options for hybrid Monte Carlo.</span>
nsamples = 100;		<span class="comment">% Number of retained samples.</span>

options = foptions;     <span class="comment">% Default options vector.</span>
options(1) = 1;		<span class="comment">% Switch on diagnostics.</span>
options(5) = 1;		<span class="comment">% Use persistence</span>
options(7) = 10;	<span class="comment">% Number of steps in trajectory.</span>
options(14) = nsamples;	<span class="comment">% Number of Monte Carlo samples returned.</span>
options(15) = 300;	<span class="comment">% Number of samples omitted at start of chain.</span>
options(17) = 0.95;	<span class="comment">% Alpha value in persistence</span>
options(18) = 0.005;	<span class="comment">% Step size.</span>

w = mlppak(net);
<span class="comment">% Initialise HMC</span>
hmc(<span class="string">'state'</span>, 42);
[samples, energies] = hmc(<span class="string">'neterr'</span>, w, options, <span class="string">'netgrad'</span>, net, x, t);


disp(<span class="string">'The plot shows the underlying noise free function, the 100 samples'</span>)
disp(<span class="string">'produced from the MLP, and their average as a Monte Carlo estimate'</span>)
disp(<span class="string">'of the true posterior average.'</span>)
disp(<span class="string">' '</span>)


nplot = 300;
plotvals = [0 : 1/(nplot - 1) : 1]';
pred = zeros(size(plotvals));
fh1 = figure;
hold <span class="string">on</span>
<span class="keyword">for</span> k = 1:nsamples
  w2 = samples(k,:);
  net2 = mlpunpak(net, w2);
  y = mlpfwd(net2, plotvals);
  <span class="comment">% Sum predictions</span>
  pred = pred + y;
  h4 = plot(plotvals, y, <span class="string">':b'</span>, <span class="string">'LineWidth'</span>, 1);
<span class="keyword">end</span>
pred = pred./nsamples;

<span class="comment">% Plot data</span>
h1 = plot(x, t, <span class="string">'ok'</span>, <span class="string">'LineWidth'</span>, 2);
<span class="comment">%axis([0 1 -3 3])</span>
axis([0 1 -1.5 1.5])

<span class="comment">% Plot function</span>
[fx, fy] = fplot(<span class="string">'sin(2*pi*x)'</span>, [0 1], <span class="string">'--g'</span>);
h2 = plot(fx, fy, <span class="string">'--g'</span>, <span class="string">'LineWidth'</span>, 2);
set(gca, <span class="string">'box'</span>, <span class="string">'on'</span>);

<span class="comment">% Plot averaged prediction</span>
h3 = plot(plotvals, pred, <span class="string">'-r'</span>, <span class="string">'LineWidth'</span>, 3);

lstrings = char(<span class="string">'Data'</span>, <span class="string">'Function'</span>, <span class="string">'Prediction'</span>, <span class="string">'Samples'</span>);
legend([h1 h2 h3 h4], lstrings, 3);
hold <span class="string">off</span>

disp(<span class="string">'Note how the predictions become much further from the true function'</span>)
disp(<span class="string">'away from the region of high data density.'</span>)

printPmtkFigure(<span class="string">'mlpRegHmc'</span>)
</pre><pre class="codeoutput">This demonstration illustrates the application of Bayesian
re-estimation to determine the hyperparameters in a simple regression
problem. It is based on a local quadratic approximation to a mode of
the posterior distribution and the evidence maximization framework of
MacKay.
 
First, we generate a synthetic data set consisting of a single input
variable x sampled from a Gaussian distribution, and a target variable
t obtained by evaluating sin(2*pi*x) and adding Gaussian noise.
Next we create a two-layer MLP network having 3 hidden units and one
linear output. The model assumes Gaussian target noise governed by an
inverse variance hyperparmeter beta, and uses a simple Gaussian prior
distribution governed by an inverse variance hyperparameter alpha.
 
The network weights and the hyperparameters are initialised and then
the weights are optimized with the scaled conjugate gradient
algorithm using the SCG function, with the hyperparameters kept
fixed. After a maximum of 500 iterations, the hyperparameters are
re-estimated using the EVIDENCE function. The process of optimizing
the weights with fixed hyperparameters and then re-estimating the
hyperparameters is repeated for a total of 3 cycles.
 
Cycle    1  Error    8.089982  Scale 1.000000e+000
Cycle    2  Error    8.058461  Scale 5.000000e-001
Cycle    3  Error    8.058461  Scale 2.500000e-001
Cycle    4  Error    8.058461  Scale 1.000000e+000
Cycle    5  Error    7.940710  Scale 4.000000e+000
Cycle    6  Error    7.935986  Scale 2.000000e+000
Cycle    7  Error    7.856725  Scale 1.000000e+000
Cycle    8  Error    7.848976  Scale 5.000000e-001
Cycle    9  Error    7.848189  Scale 2.500000e-001
Cycle   10  Error    7.846595  Scale 1.250000e-001
Cycle   11  Error    7.846337  Scale 6.250000e-002
Cycle   12  Error    7.845577  Scale 3.125000e-002
Cycle   13  Error    7.845490  Scale 1.562500e-002
Cycle   14  Error    7.678913  Scale 7.812500e-003
Cycle   15  Error    7.392927  Scale 3.906250e-003
Cycle   16  Error    7.318061  Scale 1.953125e-003
Cycle   17  Error    7.310427  Scale 9.765625e-004
Cycle   18  Error    7.310427  Scale 4.882813e-004
Cycle   19  Error    7.310427  Scale 1.953125e-003
Cycle   20  Error    7.310427  Scale 7.812500e-003
Cycle   21  Error    7.310427  Scale 3.125000e-002
Cycle   22  Error    7.310427  Scale 1.250000e-001
Cycle   23  Error    7.183774  Scale 5.000000e-001
Cycle   24  Error    7.178550  Scale 2.500000e-001
Cycle   25  Error    7.111295  Scale 1.250000e-001
Cycle   26  Error    7.111295  Scale 6.250000e-002
Cycle   27  Error    7.111295  Scale 2.500000e-001
Cycle   28  Error    7.111295  Scale 1.000000e+000
Cycle   29  Error    6.781937  Scale 4.000000e+000
Cycle   30  Error    6.701043  Scale 2.000000e+000
Cycle   31  Error    6.699761  Scale 1.000000e+000
Cycle   32  Error    6.649371  Scale 5.000000e-001
Cycle   33  Error    6.646181  Scale 2.500000e-001
Cycle   34  Error    6.586370  Scale 1.250000e-001
Cycle   35  Error    6.584797  Scale 6.250000e-002
Cycle   36  Error    6.584797  Scale 3.125000e-002
Cycle   37  Error    6.584797  Scale 1.250000e-001
Cycle   38  Error    6.584797  Scale 5.000000e-001
Cycle   39  Error    6.350048  Scale 2.000000e+000
Cycle   40  Error    6.249683  Scale 1.000000e+000
Cycle   41  Error    6.188930  Scale 5.000000e-001
Cycle   42  Error    5.999962  Scale 2.500000e-001
Cycle   43  Error    5.989289  Scale 1.250000e-001
Cycle   44  Error    5.986475  Scale 6.250000e-002
Cycle   45  Error    5.942069  Scale 3.125000e-002
Cycle   46  Error    5.940278  Scale 1.562500e-002
Cycle   47  Error    5.940278  Scale 7.812500e-003
Cycle   48  Error    5.940278  Scale 3.125000e-002
Cycle   49  Error    5.940278  Scale 1.250000e-001
Cycle   50  Error    5.940278  Scale 5.000000e-001
Cycle   51  Error    5.651959  Scale 2.000000e+000
Cycle   52  Error    5.602084  Scale 1.000000e+000
Cycle   53  Error    5.602084  Scale 5.000000e-001
Cycle   54  Error    5.277293  Scale 2.000000e+000
Cycle   55  Error    5.065115  Scale 1.000000e+000
Cycle   56  Error    4.937888  Scale 5.000000e-001
Cycle   57  Error    4.556644  Scale 5.000000e-001
Cycle   58  Error    4.186899  Scale 2.500000e-001
Cycle   59  Error    4.179866  Scale 1.250000e-001
Cycle   60  Error    4.173252  Scale 6.250000e-002
Cycle   61  Error    4.135932  Scale 3.125000e-002
Cycle   62  Error    4.056386  Scale 1.562500e-002
Cycle   63  Error    3.927522  Scale 7.812500e-003
Cycle   64  Error    3.924936  Scale 3.906250e-003
Cycle   65  Error    3.923847  Scale 1.953125e-003
Cycle   66  Error    3.922109  Scale 9.765625e-004
Cycle   67  Error    3.920945  Scale 4.882813e-004
Cycle   68  Error    3.918981  Scale 2.441406e-004
Cycle   69  Error    3.918254  Scale 1.220703e-004
Cycle   70  Error    3.909434  Scale 6.103516e-005
Cycle   71  Error    3.850788  Scale 3.051758e-005
Cycle   72  Error    3.850713  Scale 3.051758e-005
Cycle   73  Error    3.823046  Scale 1.525879e-005
Cycle   74  Error    3.813643  Scale 7.629395e-006
Cycle   75  Error    3.811207  Scale 3.814697e-006
Cycle   76  Error    3.810778  Scale 1.907349e-006
Cycle   77  Error    3.810693  Scale 9.536743e-007
Cycle   78  Error    3.810460  Scale 4.768372e-007
Cycle   79  Error    3.810402  Scale 2.384186e-007
Cycle   80  Error    3.807920  Scale 1.192093e-007
Cycle   81  Error    3.786697  Scale 5.960464e-008
Cycle   82  Error    3.770689  Scale 2.980232e-008
Cycle   83  Error    3.768949  Scale 1.490116e-008
Cycle   84  Error    3.768043  Scale 7.450581e-009
Cycle   85  Error    3.767809  Scale 3.725290e-009
Cycle   86  Error    3.762451  Scale 1.862645e-009
Cycle   87  Error    3.761174  Scale 9.313226e-010
Cycle   88  Error    3.755181  Scale 4.656613e-010
Cycle   89  Error    3.754905  Scale 2.328306e-010
Cycle   90  Error    3.746664  Scale 1.164153e-010
Cycle   91  Error    3.728737  Scale 5.820766e-011
Cycle   92  Error    3.704649  Scale 2.910383e-011
Cycle   93  Error    3.694854  Scale 1.455192e-011
Cycle   94  Error    3.694002  Scale 7.275958e-012
Cycle   95  Error    3.693015  Scale 3.637979e-012
Cycle   96  Error    3.685413  Scale 1.818989e-012
Cycle   97  Error    3.685366  Scale 9.094947e-013
Cycle   98  Error    3.684981  Scale 4.547474e-013
Cycle   99  Error    3.684950  Scale 2.273737e-013
Cycle  100  Error    3.682989  Scale 1.136868e-013
Cycle  101  Error    3.677656  Scale 5.684342e-014
Cycle  102  Error    3.676919  Scale 2.842171e-014
Cycle  103  Error    3.676667  Scale 1.421085e-014
Cycle  104  Error    3.676622  Scale 7.105427e-015
Cycle  105  Error    3.676473  Scale 3.552714e-015
Cycle  106  Error    3.676254  Scale 1.776357e-015
Cycle  107  Error    3.676015  Scale 1.000000e-015
Cycle  108  Error    3.675662  Scale 1.000000e-015
Cycle  109  Error    3.675607  Scale 1.000000e-015
Cycle  110  Error    3.675320  Scale 1.000000e-015
Cycle  111  Error    3.673248  Scale 1.000000e-015
Cycle  112  Error    3.660087  Scale 1.000000e-015
Cycle  113  Error    3.657334  Scale 1.000000e-015
Cycle  114  Error    3.649675  Scale 1.000000e-015
Cycle  115  Error    3.648880  Scale 1.000000e-015
Cycle  116  Error    3.644567  Scale 1.000000e-015
Cycle  117  Error    3.631299  Scale 1.000000e-015
Cycle  118  Error    3.630904  Scale 1.000000e-015
Cycle  119  Error    3.630876  Scale 1.000000e-015
Cycle  120  Error    3.628858  Scale 1.000000e-015
Cycle  121  Error    3.627451  Scale 1.000000e-015
Cycle  122  Error    3.627326  Scale 1.000000e-015
Cycle  123  Error    3.627302  Scale 1.000000e-015
Cycle  124  Error    3.627299  Scale 1.000000e-015
Cycle  125  Error    3.627173  Scale 1.000000e-015
Cycle  126  Error    3.627163  Scale 1.000000e-015
Cycle  127  Error    3.627065  Scale 1.000000e-015
Cycle  128  Error    3.627059  Scale 1.000000e-015
Cycle  129  Error    3.627053  Scale 1.000000e-015
Cycle  130  Error    3.626166  Scale 1.000000e-015
Cycle  131  Error    3.626142  Scale 1.000000e-015
Cycle  132  Error    3.626089  Scale 1.000000e-015
Cycle  133  Error    3.624035  Scale 1.000000e-015
Cycle  134  Error    3.622056  Scale 1.000000e-015
Cycle  135  Error    3.621037  Scale 1.000000e-015
Cycle  136  Error    3.619450  Scale 1.000000e-015
Cycle  137  Error    3.619376  Scale 1.000000e-015
Cycle  138  Error    3.619334  Scale 1.000000e-015
Cycle  139  Error    3.619332  Scale 1.000000e-015
Cycle  140  Error    3.619102  Scale 1.000000e-015
Cycle  141  Error    3.619088  Scale 1.000000e-015
Cycle  142  Error    3.619073  Scale 1.000000e-015
Cycle  143  Error    3.617525  Scale 1.000000e-015
Cycle  144  Error    3.616797  Scale 1.000000e-015
Cycle  145  Error    3.616412  Scale 1.000000e-015
Cycle  146  Error    3.616157  Scale 1.000000e-015
Cycle  147  Error    3.614469  Scale 1.000000e-015
Cycle  148  Error    3.614381  Scale 1.000000e-015
Cycle  149  Error    3.614362  Scale 1.000000e-015
Cycle  150  Error    3.613971  Scale 1.000000e-015
Cycle  151  Error    3.613307  Scale 1.000000e-015
Cycle  152  Error    3.613281  Scale 1.000000e-015
Cycle  153  Error    3.613275  Scale 1.000000e-015
Cycle  154  Error    3.613274  Scale 1.000000e-015
Cycle  155  Error    3.613084  Scale 1.000000e-015
Cycle  156  Error    3.613059  Scale 1.000000e-015
Cycle  157  Error    3.613012  Scale 1.000000e-015
Cycle  158  Error    3.612410  Scale 1.000000e-015
Cycle  159  Error    3.612122  Scale 1.000000e-015
Cycle  160  Error    3.612037  Scale 1.000000e-015
Cycle  161  Error    3.612000  Scale 1.000000e-015
Cycle  162  Error    3.611953  Scale 1.000000e-015
Cycle  163  Error    3.611948  Scale 1.000000e-015
Cycle  164  Error    3.611941  Scale 1.000000e-015
Cycle  165  Error    3.611937  Scale 1.000000e-015
Cycle  166  Error    3.611936  Scale 1.000000e-015
Cycle  167  Error    3.611917  Scale 1.000000e-015
Cycle  168  Error    3.611916  Scale 1.000000e-015
Cycle  169  Error    3.611915  Scale 1.000000e-015
Cycle  170  Error    3.611832  Scale 1.000000e-015
Cycle  171  Error    3.611830  Scale 1.000000e-015
Cycle  172  Error    3.611818  Scale 1.000000e-015
Cycle  173  Error    3.611453  Scale 1.000000e-015
Cycle  174  Error    3.611299  Scale 1.000000e-015
Cycle  175  Error    3.611189  Scale 1.000000e-015
Cycle  176  Error    3.611141  Scale 1.000000e-015
Cycle  177  Error    3.611099  Scale 1.000000e-015
Cycle  178  Error    3.611084  Scale 1.000000e-015
Cycle  179  Error    3.611076  Scale 1.000000e-015
Cycle  180  Error    3.610492  Scale 1.000000e-015
Cycle  181  Error    3.610483  Scale 1.000000e-015
Cycle  182  Error    3.610462  Scale 1.000000e-015
Cycle  183  Error    3.610421  Scale 1.000000e-015
Cycle  184  Error    3.610339  Scale 1.000000e-015
Cycle  185  Error    3.610015  Scale 1.000000e-015
Cycle  186  Error    3.609746  Scale 1.000000e-015
Cycle  187  Error    3.609712  Scale 1.000000e-015
Cycle  188  Error    3.609651  Scale 1.000000e-015
Cycle  189  Error    3.609604  Scale 1.000000e-015
Cycle  190  Error    3.609463  Scale 1.000000e-015
Cycle  191  Error    3.609304  Scale 1.000000e-015
Cycle  192  Error    3.609262  Scale 1.000000e-015
Cycle  193  Error    3.609261  Scale 1.000000e-015
Cycle  194  Error    3.609260  Scale 1.000000e-015
Cycle  195  Error    3.609258  Scale 1.000000e-015
Cycle  196  Error    3.609258  Scale 1.000000e-015
Cycle  197  Error    3.609256  Scale 1.000000e-015
Cycle  198  Error    3.609255  Scale 1.000000e-015
Cycle  199  Error    3.609255  Scale 1.000000e-015
Cycle  200  Error    3.609200  Scale 1.000000e-015
Cycle  201  Error    3.609186  Scale 1.000000e-015
Cycle  202  Error    3.609185  Scale 1.000000e-015
Cycle  203  Error    3.609185  Scale 1.000000e-015
Cycle  204  Error    3.609185  Scale 4.000000e-015
Cycle  205  Error    3.609185  Scale 1.600000e-014
Cycle  206  Error    3.609185  Scale 6.400000e-014
Cycle  207  Error    3.609185  Scale 2.560000e-013
Cycle  208  Error    3.609185  Scale 1.024000e-012
Cycle  209  Error    3.609185  Scale 4.096000e-012
Cycle  210  Error    3.609185  Scale 1.638400e-011
Cycle  211  Error    3.609185  Scale 6.553600e-011
Cycle  212  Error    3.609185  Scale 2.621440e-010
Cycle  213  Error    3.609185  Scale 1.048576e-009
Cycle  214  Error    3.609185  Scale 4.194304e-009
Cycle  215  Error    3.609185  Scale 1.677722e-008
Cycle  216  Error    3.609185  Scale 6.710886e-008
Cycle  217  Error    3.609185  Scale 2.684355e-007
Cycle  218  Error    3.609185  Scale 1.073742e-006
Cycle  219  Error    3.609185  Scale 4.294967e-006
Cycle  220  Error    3.609185  Scale 1.717987e-005
Cycle  221  Error    3.609185  Scale 6.871948e-005
Cycle  222  Error    3.609185  Scale 2.748779e-004
Cycle  223  Error    3.609185  Scale 1.099512e-003
Cycle  224  Error    3.609185  Scale 4.398047e-003
Cycle  225  Error    3.609185  Scale 1.759219e-002
Cycle  226  Error    3.609185  Scale 7.036874e-002
Cycle  227  Error    3.607692  Scale 2.814750e-001
Cycle  228  Error    3.606765  Scale 1.407375e-001
Cycle  229  Error    3.606361  Scale 7.036874e-002
Cycle  230  Error    3.606237  Scale 3.518437e-002
Cycle  231  Error    3.604993  Scale 1.759219e-002
Cycle  232  Error    3.604888  Scale 8.796093e-003
Cycle  233  Error    3.604829  Scale 4.398047e-003
Cycle  234  Error    3.604333  Scale 2.199023e-003
Cycle  235  Error    3.604330  Scale 1.099512e-003
Cycle  236  Error    3.604300  Scale 5.497558e-004
Cycle  237  Error    3.604276  Scale 2.748779e-004
Cycle  238  Error    3.604273  Scale 1.374390e-004
Cycle  239  Error    3.604263  Scale 6.871948e-005
Cycle  240  Error    3.604262  Scale 3.435974e-005
Cycle  241  Error    3.604262  Scale 1.717987e-005
Cycle  242  Error    3.604262  Scale 6.871948e-005
Cycle  243  Error    3.604262  Scale 2.748779e-004
Cycle  244  Error    3.604262  Scale 1.099512e-003
Cycle  245  Error    3.604262  Scale 4.398047e-003
Cycle  246  Error    3.604262  Scale 1.759219e-002
Cycle  247  Error    3.603385  Scale 7.036874e-002
Cycle  248  Error    3.603278  Scale 3.518437e-002
Cycle  249  Error    3.603067  Scale 1.759219e-002
Cycle  250  Error    3.602106  Scale 8.796093e-003
Cycle  251  Error    3.602102  Scale 4.398047e-003
Cycle  252  Error    3.602013  Scale 2.199023e-003
Cycle  253  Error    3.602002  Scale 1.099512e-003
Cycle  254  Error    3.602002  Scale 5.497558e-004
Cycle  255  Error    3.602002  Scale 2.748779e-004
Cycle  256  Error    3.602002  Scale 1.099512e-003
Cycle  257  Error    3.602002  Scale 4.398047e-003
Cycle  258  Error    3.601716  Scale 1.759219e-002
Cycle  259  Error    3.600498  Scale 7.036874e-002
Cycle  260  Error    3.600228  Scale 3.518437e-002
Cycle  261  Error    3.600079  Scale 1.759219e-002
Cycle  262  Error    3.599992  Scale 8.796093e-003
Cycle  263  Error    3.599941  Scale 4.398047e-003
Cycle  264  Error    3.599867  Scale 2.199023e-003
Cycle  265  Error    3.599866  Scale 1.099512e-003
Cycle  266  Error    3.599747  Scale 5.497558e-004
Cycle  267  Error    3.599726  Scale 2.748779e-004
Cycle  268  Error    3.599726  Scale 1.374390e-004
Cycle  269  Error    3.599726  Scale 5.497558e-004
Cycle  270  Error    3.599726  Scale 2.199023e-003
Cycle  271  Error    3.599726  Scale 8.796093e-003
Cycle  272  Error    3.599726  Scale 3.518437e-002
Cycle  273  Error    3.599064  Scale 1.407375e-001
Cycle  274  Error    3.598343  Scale 7.036874e-002
Cycle  275  Error    3.598063  Scale 3.518437e-002
Cycle  276  Error    3.598062  Scale 1.759219e-002
Cycle  277  Error    3.598061  Scale 8.796093e-003
Cycle  278  Error    3.598043  Scale 4.398047e-003
Cycle  279  Error    3.598039  Scale 2.199023e-003
Cycle  280  Error    3.598039  Scale 1.099512e-003
Cycle  281  Error    3.598039  Scale 5.497558e-004
Cycle  282  Error    3.598039  Scale 2.199023e-003
Cycle  283  Error    3.598039  Scale 8.796093e-003
Cycle  284  Error    3.598039  Scale 3.518437e-002
Cycle  285  Error    3.597290  Scale 1.407375e-001
Cycle  286  Error    3.597094  Scale 7.036874e-002
Cycle  287  Error    3.596486  Scale 3.518437e-002
Cycle  288  Error    3.596269  Scale 1.759219e-002
Cycle  289  Error    3.596243  Scale 8.796093e-003
Cycle  290  Error    3.596113  Scale 4.398047e-003
Cycle  291  Error    3.596102  Scale 2.199023e-003
Cycle  292  Error    3.596079  Scale 1.099512e-003
Cycle  293  Error    3.596060  Scale 5.497558e-004
Cycle  294  Error    3.596059  Scale 2.748779e-004
Cycle  295  Error    3.595983  Scale 1.374390e-004
Cycle  296  Error    3.595977  Scale 6.871948e-005
Cycle  297  Error    3.595879  Scale 3.435974e-005
Cycle  298  Error    3.595878  Scale 1.717987e-005
Cycle  299  Error    3.595695  Scale 8.589935e-006
Cycle  300  Error    3.595676  Scale 8.589935e-006
Cycle  301  Error    3.595644  Scale 4.294967e-006
Cycle  302  Error    3.595544  Scale 2.147484e-006
Cycle  303  Error    3.595412  Scale 1.073742e-006
Cycle  304  Error    3.595405  Scale 5.368709e-007
Cycle  305  Error    3.595395  Scale 2.684355e-007
Cycle  306  Error    3.595395  Scale 1.342177e-007
Cycle  307  Error    3.595379  Scale 6.710886e-008
Cycle  308  Error    3.595368  Scale 3.355443e-008
Cycle  309  Error    3.595102  Scale 1.677722e-008
Cycle  310  Error    3.595100  Scale 8.388608e-009
Cycle  311  Error    3.595098  Scale 4.194304e-009
Cycle  312  Error    3.595026  Scale 2.097152e-009
Cycle  313  Error    3.594969  Scale 1.048576e-009
Cycle  314  Error    3.594968  Scale 5.242880e-010
Cycle  315  Error    3.594955  Scale 2.621440e-010
Cycle  316  Error    3.594953  Scale 1.310720e-010
Cycle  317  Error    3.594889  Scale 6.553600e-011
Cycle  318  Error    3.594888  Scale 3.276800e-011
Cycle  319  Error    3.594862  Scale 1.638400e-011
Cycle  320  Error    3.594861  Scale 8.192000e-012
Cycle  321  Error    3.594861  Scale 4.096000e-012
Cycle  322  Error    3.594854  Scale 2.048000e-012
Cycle  323  Error    3.594841  Scale 1.024000e-012
Cycle  324  Error    3.594840  Scale 5.120000e-013
Cycle  325  Error    3.594840  Scale 2.560000e-013
Cycle  326  Error    3.594840  Scale 1.024000e-012
Cycle  327  Error    3.594840  Scale 4.096000e-012
Cycle  328  Error    3.594840  Scale 1.638400e-011
Cycle  329  Error    3.594840  Scale 6.553600e-011
Cycle  330  Error    3.594840  Scale 2.621440e-010
Cycle  331  Error    3.594840  Scale 1.048576e-009
Cycle  332  Error    3.594840  Scale 4.194304e-009
Cycle  333  Error    3.594840  Scale 1.677722e-008
Cycle  334  Error    3.594840  Scale 6.710886e-008
Cycle  335  Error    3.594840  Scale 2.684355e-007
Cycle  336  Error    3.594840  Scale 1.073742e-006
Cycle  337  Error    3.594840  Scale 4.294967e-006
Cycle  338  Error    3.594840  Scale 1.717987e-005
Cycle  339  Error    3.594840  Scale 6.871948e-005
Cycle  340  Error    3.594840  Scale 2.748779e-004
Cycle  341  Error    3.594840  Scale 1.099512e-003
Cycle  342  Error    3.594840  Scale 4.398047e-003
Cycle  343  Error    3.594840  Scale 1.759219e-002
Cycle  344  Error    3.594624  Scale 7.036874e-002
Cycle  345  Error    3.594599  Scale 3.518437e-002
Cycle  346  Error    3.594454  Scale 1.759219e-002
Cycle  347  Error    3.594303  Scale 8.796093e-003
Cycle  348  Error    3.594302  Scale 4.398047e-003
Cycle  349  Error    3.594197  Scale 2.199023e-003
Cycle  350  Error    3.594192  Scale 1.099512e-003
Cycle  351  Error    3.594152  Scale 5.497558e-004
Cycle  352  Error    3.594146  Scale 2.748779e-004
Cycle  353  Error    3.594143  Scale 1.374390e-004
Cycle  354  Error    3.594142  Scale 6.871948e-005
Cycle  355  Error    3.594142  Scale 3.435974e-005
Cycle  356  Error    3.594029  Scale 1.717987e-005
Cycle  357  Error    3.594025  Scale 8.589935e-006
Cycle  358  Error    3.594020  Scale 4.294967e-006
Cycle  359  Error    3.594020  Scale 2.147484e-006
Cycle  360  Error    3.594019  Scale 1.073742e-006
Cycle  361  Error    3.594016  Scale 5.368709e-007
Cycle  362  Error    3.594007  Scale 2.684355e-007
Cycle  363  Error    3.594007  Scale 1.342177e-007
Cycle  364  Error    3.593928  Scale 6.710886e-008
Cycle  365  Error    3.593921  Scale 3.355443e-008
Cycle  366  Error    3.593910  Scale 1.677722e-008
Cycle  367  Error    3.593908  Scale 8.388608e-009
Cycle  368  Error    3.593907  Scale 4.194304e-009
Cycle  369  Error    3.593907  Scale 2.097152e-009
Cycle  370  Error    3.593907  Scale 1.048576e-009
Cycle  371  Error    3.593906  Scale 5.242880e-010
Cycle  372  Error    3.593904  Scale 2.621440e-010
Cycle  373  Error    3.593904  Scale 1.310720e-010
Cycle  374  Error    3.593878  Scale 6.553600e-011
Cycle  375  Error    3.593875  Scale 3.276800e-011
Cycle  376  Error    3.593864  Scale 1.638400e-011
Cycle  377  Error    3.593784  Scale 6.553600e-011
Cycle  378  Error    3.593779  Scale 3.276800e-011
Cycle  379  Error    3.593770  Scale 1.638400e-011
Cycle  380  Error    3.593770  Scale 8.192000e-012
Cycle  381  Error    3.593761  Scale 4.096000e-012
Cycle  382  Error    3.593751  Scale 2.048000e-012
Cycle  383  Error    3.593644  Scale 1.024000e-012
Cycle  384  Error    3.593643  Scale 5.120000e-013
Cycle  385  Error    3.593643  Scale 2.560000e-013
Cycle  386  Error    3.593643  Scale 1.280000e-013
Cycle  387  Error    3.593643  Scale 6.400000e-014
Cycle  388  Error    3.593643  Scale 3.200000e-014
Cycle  389  Error    3.593642  Scale 1.600000e-014
Cycle  390  Error    3.593642  Scale 8.000000e-015
Cycle  391  Error    3.593642  Scale 4.000000e-015
Cycle  392  Error    3.593636  Scale 2.000000e-015
Cycle  393  Error    3.593636  Scale 1.000000e-015
Cycle  394  Error    3.593588  Scale 1.000000e-015
Cycle  395  Error    3.593582  Scale 1.000000e-015
Cycle  396  Error    3.593580  Scale 1.000000e-015
Cycle  397  Error    3.593579  Scale 1.000000e-015
Cycle  398  Error    3.593578  Scale 1.000000e-015
Cycle  399  Error    3.593577  Scale 1.000000e-015
Cycle  400  Error    3.593577  Scale 1.000000e-015
Cycle  401  Error    3.593576  Scale 1.000000e-015
Cycle  402  Error    3.593564  Scale 1.000000e-015
Cycle  403  Error    3.593564  Scale 1.000000e-015
Cycle  404  Error    3.593520  Scale 1.000000e-015
Cycle  405  Error    3.593520  Scale 1.000000e-015
Cycle  406  Error    3.593520  Scale 1.000000e-015
Cycle  407  Error    3.593520  Scale 1.000000e-015
Cycle  408  Error    3.593519  Scale 1.000000e-015
Cycle  409  Error    3.593519  Scale 1.000000e-015
Cycle  410  Error    3.593519  Scale 1.000000e-015
Cycle  411  Error    3.593519  Scale 1.000000e-015
Cycle  412  Error    3.593517  Scale 1.000000e-015
Cycle  413  Error    3.593517  Scale 1.000000e-015
Cycle  414  Error    3.593489  Scale 1.000000e-015
Cycle  415  Error    3.593456  Scale 1.000000e-015
Cycle  416  Error    3.593456  Scale 1.000000e-015
Cycle  417  Error    3.593450  Scale 1.000000e-015
Cycle  418  Error    3.593450  Scale 1.000000e-015
Cycle  419  Error    3.593402  Scale 1.000000e-015
Cycle  420  Error    3.593401  Scale 1.000000e-015
Cycle  421  Error    3.593401  Scale 1.000000e-015
Cycle  422  Error    3.593395  Scale 1.000000e-015
Cycle  423  Error    3.593395  Scale 1.000000e-015
Cycle  424  Error    3.593365  Scale 1.000000e-015
Cycle  425  Error    3.593362  Scale 1.000000e-015
Cycle  426  Error    3.593352  Scale 1.000000e-015
Cycle  427  Error    3.593352  Scale 1.000000e-015
Cycle  428  Error    3.593352  Scale 1.000000e-015
Cycle  429  Error    3.593347  Scale 1.000000e-015
Cycle  430  Error    3.593347  Scale 1.000000e-015
Cycle  431  Error    3.593343  Scale 1.000000e-015
Cycle  432  Error    3.593343  Scale 1.000000e-015
Cycle  433  Error    3.593343  Scale 1.000000e-015
Cycle  434  Error    3.593304  Scale 1.000000e-015
Cycle  435  Error    3.593303  Scale 1.000000e-015
Cycle  436  Error    3.593303  Scale 1.000000e-015
Cycle  437  Error    3.593303  Scale 1.000000e-015
Cycle  438  Error    3.593303  Scale 1.000000e-015
Cycle  439  Error    3.593300  Scale 1.000000e-015
Cycle  440  Error    3.593299  Scale 1.000000e-015
Cycle  441  Error    3.593299  Scale 1.000000e-015
Cycle  442  Error    3.593298  Scale 1.000000e-015
Cycle  443  Error    3.593297  Scale 1.000000e-015
Cycle  444  Error    3.593297  Scale 1.000000e-015
Cycle  445  Error    3.593297  Scale 4.000000e-015
Cycle  446  Error    3.593297  Scale 1.600000e-014
Cycle  447  Error    3.593297  Scale 6.400000e-014
Cycle  448  Error    3.593297  Scale 2.560000e-013
Cycle  449  Error    3.593297  Scale 1.024000e-012
Cycle  450  Error    3.593297  Scale 4.096000e-012
Cycle  451  Error    3.593297  Scale 1.638400e-011
Cycle  452  Error    3.593297  Scale 6.553600e-011
Cycle  453  Error    3.593297  Scale 2.621440e-010
Cycle  454  Error    3.593297  Scale 1.048576e-009
Cycle  455  Error    3.593297  Scale 4.194304e-009
Cycle  456  Error    3.593297  Scale 1.677722e-008
Cycle  457  Error    3.593297  Scale 6.710886e-008
Cycle  458  Error    3.593297  Scale 2.684355e-007
Cycle  459  Error    3.593297  Scale 1.073742e-006
Cycle  460  Error    3.593297  Scale 4.294967e-006
Cycle  461  Error    3.593297  Scale 1.717987e-005
Cycle  462  Error    3.593297  Scale 6.871948e-005
Cycle  463  Error    3.593297  Scale 2.748779e-004
Cycle  464  Error    3.593297  Scale 1.099512e-003
Cycle  465  Error    3.593297  Scale 4.398047e-003
Cycle  466  Error    3.593297  Scale 1.759219e-002
Cycle  467  Error    3.593259  Scale 7.036874e-002
Cycle  468  Error    3.593222  Scale 3.518437e-002
Cycle  469  Error    3.593217  Scale 1.759219e-002
Cycle  470  Error    3.593199  Scale 8.796093e-003
Cycle  471  Error    3.593185  Scale 4.398047e-003
Cycle  472  Error    3.593185  Scale 2.199023e-003
Cycle  473  Error    3.593182  Scale 8.796093e-003
Cycle  474  Error    3.593133  Scale 3.518437e-002
Cycle  475  Error    3.593128  Scale 1.759219e-002
Cycle  476  Error    3.593123  Scale 8.796093e-003
Cycle  477  Error    3.593123  Scale 4.398047e-003
Cycle  478  Error    3.593086  Scale 2.199023e-003
Cycle  479  Error    3.593085  Scale 1.099512e-003
Cycle  480  Error    3.593082  Scale 5.497558e-004
Cycle  481  Error    3.593082  Scale 2.748779e-004
Cycle  482  Error    3.593080  Scale 1.374390e-004
Cycle  483  Error    3.593075  Scale 6.871948e-005
Cycle  484  Error    3.593074  Scale 3.435974e-005
Cycle  485  Error    3.593070  Scale 1.717987e-005
Cycle  486  Error    3.593069  Scale 8.589935e-006
Cycle  487  Error    3.593069  Scale 4.294967e-006
Cycle  488  Error    3.593061  Scale 2.147484e-006
Cycle  489  Error    3.593005  Scale 1.073742e-006
Cycle  490  Error    3.593004  Scale 5.368709e-007
Cycle  491  Error    3.593000  Scale 2.684355e-007
Cycle  492  Error    3.593000  Scale 1.342177e-007
Cycle  493  Error    3.592999  Scale 6.710886e-008
Cycle  494  Error    3.592998  Scale 3.355443e-008
Cycle  495  Error    3.592998  Scale 1.677722e-008
Cycle  496  Error    3.592952  Scale 8.388608e-009
Cycle  497  Error    3.592952  Scale 4.194304e-009
Cycle  498  Error    3.592947  Scale 2.097152e-009
Cycle  499  Error    3.592936  Scale 1.048576e-009
Cycle  500  Error    3.592935  Scale 5.242880e-010
Maximum number of iterations has been exceeded

Re-estimation cycle 1:
  alpha =   0.10728
  beta  =  69.83252
  gamma =   6.85645

 
Cycle    1  Error    7.996398  Scale 1.000000e+000
Cycle    2  Error    7.794134  Scale 5.000000e-001
Cycle    3  Error    7.793539  Scale 2.500000e-001
Cycle    4  Error    7.762142  Scale 1.250000e-001
Cycle    5  Error    7.760715  Scale 6.250000e-002
Cycle    6  Error    7.602606  Scale 3.125000e-002
Cycle    7  Error    7.601912  Scale 1.562500e-002
Cycle    8  Error    7.594259  Scale 7.812500e-003
Cycle    9  Error    7.594152  Scale 3.906250e-003
Cycle   10  Error    7.590214  Scale 1.953125e-003
Cycle   11  Error    7.589790  Scale 9.765625e-004
Cycle   12  Error    7.588160  Scale 4.882813e-004
Cycle   13  Error    7.585920  Scale 2.441406e-004
Cycle   14  Error    7.575905  Scale 1.220703e-004
Cycle   15  Error    7.573987  Scale 6.103516e-005
Cycle   16  Error    7.567425  Scale 3.051758e-005
Cycle   17  Error    7.562239  Scale 1.525879e-005
Cycle   18  Error    7.528550  Scale 7.629395e-006
Cycle   19  Error    7.486808  Scale 3.814697e-006
Cycle   20  Error    7.486371  Scale 1.907349e-006
Cycle   21  Error    7.482565  Scale 9.536743e-007
Cycle   22  Error    7.482510  Scale 4.768372e-007
Cycle   23  Error    7.462021  Scale 2.384186e-007
Cycle   24  Error    7.461964  Scale 1.192093e-007
Cycle   25  Error    7.458614  Scale 5.960464e-008
Cycle   26  Error    7.456322  Scale 2.980232e-008
Cycle   27  Error    7.456322  Scale 1.490116e-008
Cycle   28  Error    7.456322  Scale 5.960464e-008
Cycle   29  Error    7.456322  Scale 2.384186e-007
Cycle   30  Error    7.456322  Scale 9.536743e-007
Cycle   31  Error    7.456322  Scale 3.814697e-006
Cycle   32  Error    7.456322  Scale 1.525879e-005
Cycle   33  Error    7.456322  Scale 6.103516e-005
Cycle   34  Error    7.456322  Scale 2.441406e-004
Cycle   35  Error    7.456322  Scale 9.765625e-004
Cycle   36  Error    7.456322  Scale 3.906250e-003
Cycle   37  Error    7.456322  Scale 1.562500e-002
Cycle   38  Error    7.456322  Scale 6.250000e-002
Cycle   39  Error    7.432795  Scale 2.500000e-001
Cycle   40  Error    7.353742  Scale 2.500000e-001
Cycle   41  Error    7.347729  Scale 1.250000e-001
Cycle   42  Error    7.347160  Scale 6.250000e-002
Cycle   43  Error    7.346603  Scale 3.125000e-002
Cycle   44  Error    7.341901  Scale 1.562500e-002
Cycle   45  Error    7.328628  Scale 7.812500e-003
Cycle   46  Error    7.316562  Scale 3.906250e-003
Cycle   47  Error    7.316562  Scale 1.953125e-003
Cycle   48  Error    7.316413  Scale 9.765625e-004
Cycle   49  Error    7.316334  Scale 4.882813e-004
Cycle   50  Error    7.316217  Scale 2.441406e-004
Cycle   51  Error    7.316128  Scale 1.220703e-004
Cycle   52  Error    7.315970  Scale 6.103516e-005
Cycle   53  Error    7.315877  Scale 3.051758e-005
Cycle   54  Error    7.314957  Scale 1.525879e-005
Cycle   55  Error    7.298319  Scale 7.629395e-006
Cycle   56  Error    7.297041  Scale 3.814697e-006
Cycle   57  Error    7.296011  Scale 1.907349e-006
Cycle   58  Error    7.295932  Scale 9.536743e-007
Cycle   59  Error    7.287285  Scale 4.768372e-007
Cycle   60  Error    7.286030  Scale 2.384186e-007
Cycle   61  Error    7.280532  Scale 1.192093e-007
Cycle   62  Error    7.271717  Scale 5.960464e-008
Cycle   63  Error    7.262903  Scale 2.980232e-008
Cycle   64  Error    7.259306  Scale 1.490116e-008
Cycle   65  Error    7.250675  Scale 7.450581e-009
Cycle   66  Error    7.227648  Scale 3.725290e-009
Cycle   67  Error    7.226863  Scale 1.862645e-009
Cycle   68  Error    7.226270  Scale 9.313226e-010
Cycle   69  Error    7.226184  Scale 4.656613e-010
Cycle   70  Error    7.225846  Scale 2.328306e-010
Cycle   71  Error    7.225749  Scale 1.164153e-010
Cycle   72  Error    7.225310  Scale 5.820766e-011
Cycle   73  Error    7.224976  Scale 2.910383e-011
Cycle   74  Error    7.224627  Scale 1.455192e-011
Cycle   75  Error    7.217098  Scale 7.275958e-012
Cycle   76  Error    7.213895  Scale 3.637979e-012
Cycle   77  Error    7.207169  Scale 1.818989e-012
Cycle   78  Error    7.207063  Scale 9.094947e-013
Cycle   79  Error    7.205740  Scale 4.547474e-013
Cycle   80  Error    7.199691  Scale 2.273737e-013
Cycle   81  Error    7.196177  Scale 1.136868e-013
Cycle   82  Error    7.196033  Scale 5.684342e-014
Cycle   83  Error    7.195936  Scale 2.842171e-014
Cycle   84  Error    7.195488  Scale 1.421085e-014
Cycle   85  Error    7.194375  Scale 7.105427e-015
Cycle   86  Error    7.187655  Scale 3.552714e-015
Cycle   87  Error    7.186451  Scale 1.776357e-015
Cycle   88  Error    7.186451  Scale 1.000000e-015
Cycle   89  Error    7.186451  Scale 4.000000e-015
Cycle   90  Error    7.186451  Scale 1.600000e-014
Cycle   91  Error    7.186451  Scale 6.400000e-014
Cycle   92  Error    7.186451  Scale 2.560000e-013
Cycle   93  Error    7.186451  Scale 1.024000e-012
Cycle   94  Error    7.186451  Scale 4.096000e-012
Cycle   95  Error    7.186451  Scale 1.638400e-011
Cycle   96  Error    7.186451  Scale 6.553600e-011
Cycle   97  Error    7.186451  Scale 2.621440e-010
Cycle   98  Error    7.186451  Scale 1.048576e-009
Cycle   99  Error    7.186451  Scale 4.194304e-009
Cycle  100  Error    7.186451  Scale 1.677722e-008
Cycle  101  Error    7.186451  Scale 6.710886e-008
Cycle  102  Error    7.186451  Scale 2.684355e-007
Cycle  103  Error    7.186451  Scale 1.073742e-006
Cycle  104  Error    7.186451  Scale 4.294967e-006
Cycle  105  Error    7.186451  Scale 1.717987e-005
Cycle  106  Error    7.186451  Scale 6.871948e-005
Cycle  107  Error    7.186451  Scale 2.748779e-004
Cycle  108  Error    7.186451  Scale 1.099512e-003
Cycle  109  Error    7.186451  Scale 4.398047e-003
Cycle  110  Error    7.186451  Scale 1.759219e-002
Cycle  111  Error    7.179657  Scale 7.036874e-002
Cycle  112  Error    7.147944  Scale 7.036874e-002
Cycle  113  Error    7.122622  Scale 3.518437e-002
Cycle  114  Error    7.122602  Scale 1.759219e-002
Cycle  115  Error    7.110991  Scale 8.796093e-003
Cycle  116  Error    7.110900  Scale 4.398047e-003
Cycle  117  Error    7.105211  Scale 2.199023e-003
Cycle  118  Error    7.104707  Scale 1.099512e-003
Cycle  119  Error    7.100111  Scale 5.497558e-004
Cycle  120  Error    7.100082  Scale 2.748779e-004
Cycle  121  Error    7.099927  Scale 1.374390e-004
Cycle  122  Error    7.099898  Scale 6.871948e-005
Cycle  123  Error    7.099302  Scale 3.435974e-005
Cycle  124  Error    7.099231  Scale 1.717987e-005
Cycle  125  Error    7.098889  Scale 8.589935e-006
Cycle  126  Error    7.098861  Scale 4.294967e-006
Cycle  127  Error    7.095101  Scale 2.147484e-006
Cycle  128  Error    7.087485  Scale 1.073742e-006
Cycle  129  Error    7.085176  Scale 5.368709e-007
Cycle  130  Error    7.085095  Scale 2.684355e-007
Cycle  131  Error    7.085080  Scale 1.342177e-007
Cycle  132  Error    7.085041  Scale 6.710886e-008
Cycle  133  Error    7.085029  Scale 3.355443e-008
Cycle  134  Error    7.084949  Scale 1.677722e-008
Cycle  135  Error    7.084915  Scale 8.388608e-009
Cycle  136  Error    7.084884  Scale 4.194304e-009
Cycle  137  Error    7.084589  Scale 2.097152e-009
Cycle  138  Error    7.080769  Scale 1.048576e-009
Cycle  139  Error    7.076145  Scale 5.242880e-010
Cycle  140  Error    7.076000  Scale 2.621440e-010
Cycle  141  Error    7.075849  Scale 1.310720e-010
Cycle  142  Error    7.075814  Scale 6.553600e-011
Cycle  143  Error    7.075721  Scale 3.276800e-011
Cycle  144  Error    7.075696  Scale 1.638400e-011
Cycle  145  Error    7.075604  Scale 8.192000e-012
Cycle  146  Error    7.075555  Scale 4.096000e-012
Cycle  147  Error    7.075149  Scale 2.048000e-012
Cycle  148  Error    7.070215  Scale 1.024000e-012
Cycle  149  Error    7.066459  Scale 5.120000e-013
Cycle  150  Error    7.066183  Scale 2.560000e-013
Cycle  151  Error    7.066108  Scale 1.280000e-013
Cycle  152  Error    7.066036  Scale 6.400000e-014
Cycle  153  Error    7.066015  Scale 3.200000e-014
Cycle  154  Error    7.065892  Scale 1.600000e-014
Cycle  155  Error    7.065840  Scale 8.000000e-015
Cycle  156  Error    7.065791  Scale 4.000000e-015
Cycle  157  Error    7.065475  Scale 2.000000e-015
Cycle  158  Error    7.063654  Scale 1.000000e-015
Cycle  159  Error    7.059397  Scale 1.000000e-015
Cycle  160  Error    7.059276  Scale 1.000000e-015
Cycle  161  Error    7.058556  Scale 1.000000e-015
Cycle  162  Error    7.058502  Scale 1.000000e-015
Cycle  163  Error    7.058348  Scale 1.000000e-015
Cycle  164  Error    7.058321  Scale 1.000000e-015
Cycle  165  Error    7.053897  Scale 1.000000e-015
Cycle  166  Error    7.053669  Scale 1.000000e-015
Cycle  167  Error    7.052272  Scale 1.000000e-015
Cycle  168  Error    7.052213  Scale 1.000000e-015
Cycle  169  Error    7.051405  Scale 1.000000e-015
Cycle  170  Error    7.046207  Scale 1.000000e-015
Cycle  171  Error    7.045886  Scale 1.000000e-015
Cycle  172  Error    7.045704  Scale 1.000000e-015
Cycle  173  Error    7.045579  Scale 1.000000e-015
Cycle  174  Error    7.045489  Scale 1.000000e-015
Cycle  175  Error    7.043848  Scale 1.000000e-015
Cycle  176  Error    7.043648  Scale 1.000000e-015
Cycle  177  Error    7.043152  Scale 1.000000e-015
Cycle  178  Error    7.040844  Scale 1.000000e-015
Cycle  179  Error    7.035479  Scale 1.000000e-015
Cycle  180  Error    7.035455  Scale 1.000000e-015
Cycle  181  Error    7.035416  Scale 1.000000e-015
Cycle  182  Error    7.035407  Scale 1.000000e-015
Cycle  183  Error    7.035394  Scale 1.000000e-015
Cycle  184  Error    7.035390  Scale 1.000000e-015
Cycle  185  Error    7.035381  Scale 1.000000e-015
Cycle  186  Error    7.035378  Scale 1.000000e-015
Cycle  187  Error    7.035198  Scale 1.000000e-015
Cycle  188  Error    7.020059  Scale 1.000000e-015
Cycle  189  Error    7.019957  Scale 1.000000e-015
Cycle  190  Error    7.019351  Scale 1.000000e-015
Cycle  191  Error    7.019291  Scale 1.000000e-015
Cycle  192  Error    7.015339  Scale 1.000000e-015
Cycle  193  Error    7.013945  Scale 1.000000e-015
Cycle  194  Error    7.000587  Scale 4.000000e-015
Cycle  195  Error    6.998280  Scale 2.000000e-015
Cycle  196  Error    6.998268  Scale 1.000000e-015
Cycle  197  Error    6.996573  Scale 1.000000e-015
Cycle  198  Error    6.995108  Scale 1.000000e-015
Cycle  199  Error    6.994457  Scale 1.000000e-015
Cycle  200  Error    6.994454  Scale 1.000000e-015
Cycle  201  Error    6.994453  Scale 1.000000e-015
Cycle  202  Error    6.994452  Scale 1.000000e-015
Cycle  203  Error    6.994450  Scale 1.000000e-015
Cycle  204  Error    6.994448  Scale 1.000000e-015
Cycle  205  Error    6.994447  Scale 1.000000e-015
Cycle  206  Error    6.994446  Scale 1.000000e-015
Cycle  207  Error    6.994434  Scale 1.000000e-015
Cycle  208  Error    6.993587  Scale 1.000000e-015
Cycle  209  Error    6.993586  Scale 1.000000e-015
Cycle  210  Error    6.993398  Scale 1.000000e-015
Cycle  211  Error    6.993089  Scale 1.000000e-015
Cycle  212  Error    6.993089  Scale 1.000000e-015
Cycle  213  Error    6.993089  Scale 4.000000e-015
Cycle  214  Error    6.993089  Scale 1.600000e-014
Cycle  215  Error    6.993089  Scale 6.400000e-014
Cycle  216  Error    6.993089  Scale 2.560000e-013
Cycle  217  Error    6.993089  Scale 1.024000e-012
Cycle  218  Error    6.993089  Scale 4.096000e-012
Cycle  219  Error    6.993089  Scale 1.638400e-011
Cycle  220  Error    6.993089  Scale 6.553600e-011
Cycle  221  Error    6.993089  Scale 2.621440e-010
Cycle  222  Error    6.993089  Scale 1.048576e-009
Cycle  223  Error    6.993089  Scale 4.194304e-009
Cycle  224  Error    6.993089  Scale 1.677722e-008
Cycle  225  Error    6.993089  Scale 6.710886e-008
Cycle  226  Error    6.993089  Scale 2.684355e-007
Cycle  227  Error    6.993089  Scale 1.073742e-006
Cycle  228  Error    6.993089  Scale 4.294967e-006
Cycle  229  Error    6.993089  Scale 1.717987e-005
Cycle  230  Error    6.993089  Scale 6.871948e-005
Cycle  231  Error    6.993089  Scale 2.748779e-004
Cycle  232  Error    6.993089  Scale 1.099512e-003
Cycle  233  Error    6.993089  Scale 4.398047e-003
Cycle  234  Error    6.992911  Scale 1.759219e-002
Cycle  235  Error    6.991699  Scale 7.036874e-002
Cycle  236  Error    6.991678  Scale 3.518437e-002
Cycle  237  Error    6.991292  Scale 1.759219e-002
Cycle  238  Error    6.991138  Scale 8.796093e-003
Cycle  239  Error    6.991131  Scale 4.398047e-003
Cycle  240  Error    6.990649  Scale 2.199023e-003
Cycle  241  Error    6.990631  Scale 1.099512e-003
Cycle  242  Error    6.990626  Scale 5.497558e-004
Cycle  243  Error    6.990626  Scale 2.748779e-004
Cycle  244  Error    6.990588  Scale 1.374390e-004
Cycle  245  Error    6.990588  Scale 6.871948e-005
Cycle  246  Error    6.990583  Scale 3.435974e-005
Cycle  247  Error    6.990583  Scale 1.717987e-005
Cycle  248  Error    6.990583  Scale 8.589935e-006
Cycle  249  Error    6.990580  Scale 4.294967e-006
Cycle  250  Error    6.990474  Scale 2.147484e-006
Cycle  251  Error    6.990474  Scale 1.073742e-006
Cycle  252  Error    6.990451  Scale 5.368709e-007
Cycle  253  Error    6.990350  Scale 2.684355e-007
Cycle  254  Error    6.990251  Scale 1.342177e-007
Cycle  255  Error    6.990249  Scale 6.710886e-008
Cycle  256  Error    6.990235  Scale 3.355443e-008
Cycle  257  Error    6.990233  Scale 1.677722e-008
Cycle  258  Error    6.990232  Scale 8.388608e-009
Cycle  259  Error    6.990231  Scale 4.194304e-009
Cycle  260  Error    6.990122  Scale 2.097152e-009
Cycle  261  Error    6.990120  Scale 1.048576e-009
Cycle  262  Error    6.990119  Scale 5.242880e-010
Cycle  263  Error    6.990112  Scale 2.621440e-010
Cycle  264  Error    6.990105  Scale 1.310720e-010
Cycle  265  Error    6.990105  Scale 6.553600e-011
Cycle  266  Error    6.990105  Scale 3.276800e-011
Cycle  267  Error    6.990105  Scale 1.638400e-011
Cycle  268  Error    6.990105  Scale 8.192000e-012
Cycle  269  Error    6.990104  Scale 4.096000e-012
Cycle  270  Error    6.990062  Scale 2.048000e-012
Cycle  271  Error    6.990062  Scale 1.024000e-012
Cycle  272  Error    6.990005  Scale 5.120000e-013
Cycle  273  Error    6.990003  Scale 2.560000e-013
Cycle  274  Error    6.989985  Scale 1.280000e-013
Cycle  275  Error    6.989985  Scale 6.400000e-014
Cycle  276  Error    6.989985  Scale 3.200000e-014
Cycle  277  Error    6.989985  Scale 1.600000e-014
Cycle  278  Error    6.989985  Scale 8.000000e-015
Cycle  279  Error    6.989985  Scale 4.000000e-015
Cycle  280  Error    6.989975  Scale 2.000000e-015
Cycle  281  Error    6.989974  Scale 1.000000e-015
Cycle  282  Error    6.989974  Scale 1.000000e-015
Cycle  283  Error    6.989974  Scale 1.000000e-015
Cycle  284  Error    6.989974  Scale 1.000000e-015
Cycle  285  Error    6.989974  Scale 1.000000e-015
Cycle  286  Error    6.989974  Scale 1.000000e-015
Cycle  287  Error    6.989974  Scale 1.000000e-015
Cycle  288  Error    6.989974  Scale 1.000000e-015
Cycle  289  Error    6.989974  Scale 1.000000e-015
Cycle  290  Error    6.989974  Scale 1.000000e-015
Cycle  291  Error    6.989974  Scale 1.000000e-015
Cycle  292  Error    6.989972  Scale 1.000000e-015
Cycle  293  Error    6.989972  Scale 1.000000e-015
Cycle  294  Error    6.989970  Scale 1.000000e-015
Cycle  295  Error    6.989970  Scale 1.000000e-015
Cycle  296  Error    6.989970  Scale 1.000000e-015
Cycle  297  Error    6.989970  Scale 1.000000e-015
Cycle  298  Error    6.989970  Scale 1.000000e-015
Cycle  299  Error    6.989969  Scale 1.000000e-015
Cycle  300  Error    6.989969  Scale 1.000000e-015
Cycle  301  Error    6.989969  Scale 1.000000e-015
Cycle  302  Error    6.989969  Scale 1.000000e-015
Cycle  303  Error    6.989969  Scale 1.000000e-015
Cycle  304  Error    6.989969  Scale 1.000000e-015
Cycle  305  Error    6.989969  Scale 1.000000e-015
Cycle  306  Error    6.989969  Scale 1.000000e-015
Cycle  307  Error    6.989969  Scale 1.000000e-015
Cycle  308  Error    6.989969  Scale 1.000000e-015
Cycle  309  Error    6.989969  Scale 1.000000e-015
Cycle  310  Error    6.989969  Scale 1.000000e-015
Cycle  311  Error    6.989969  Scale 1.000000e-015
Cycle  312  Error    6.989969  Scale 1.000000e-015
Cycle  313  Error    6.989969  Scale 1.000000e-015
Cycle  314  Error    6.989969  Scale 1.000000e-015
Cycle  315  Error    6.989969  Scale 1.000000e-015
Cycle  316  Error    6.989969  Scale 1.000000e-015
Cycle  317  Error    6.989969  Scale 1.000000e-015
Cycle  318  Error    6.989969  Scale 1.000000e-015

Re-estimation cycle 2:
  alpha =   0.16614
  beta  =  69.39384
  gamma =   5.88273

 
Cycle    1  Error    7.999629  Scale 1.000000e+000
Cycle    2  Error    7.986527  Scale 5.000000e-001
Cycle    3  Error    7.971493  Scale 2.500000e-001
Cycle    4  Error    7.971177  Scale 1.250000e-001
Cycle    5  Error    7.969793  Scale 6.250000e-002
Cycle    6  Error    7.969734  Scale 3.125000e-002
Cycle    7  Error    7.968842  Scale 1.562500e-002
Cycle    8  Error    7.968785  Scale 7.812500e-003
Cycle    9  Error    7.968256  Scale 3.906250e-003
Cycle   10  Error    7.966851  Scale 1.953125e-003
Cycle   11  Error    7.966040  Scale 9.765625e-004
Cycle   12  Error    7.961396  Scale 4.882813e-004
Cycle   13  Error    7.961169  Scale 2.441406e-004
Cycle   14  Error    7.958423  Scale 1.220703e-004
Cycle   15  Error    7.958397  Scale 6.103516e-005
Cycle   16  Error    7.958360  Scale 3.051758e-005
Cycle   17  Error    7.958355  Scale 1.525879e-005
Cycle   18  Error    7.957825  Scale 7.629395e-006
Cycle   19  Error    7.957782  Scale 3.814697e-006
Cycle   20  Error    7.957575  Scale 1.907349e-006
Cycle   21  Error    7.957571  Scale 9.536743e-007
Cycle   22  Error    7.957454  Scale 4.768372e-007
Cycle   23  Error    7.955767  Scale 2.384186e-007
Cycle   24  Error    7.955717  Scale 1.192093e-007
Cycle   25  Error    7.955692  Scale 5.960464e-008
Cycle   26  Error    7.955691  Scale 2.980232e-008
Cycle   27  Error    7.955678  Scale 1.490116e-008
Cycle   28  Error    7.955677  Scale 7.450581e-009
Cycle   29  Error    7.955617  Scale 3.725290e-009
Cycle   30  Error    7.955614  Scale 1.862645e-009
Cycle   31  Error    7.955611  Scale 9.313226e-010
Cycle   32  Error    7.955253  Scale 4.656613e-010
Cycle   33  Error    7.955220  Scale 2.328306e-010
Cycle   34  Error    7.955205  Scale 1.164153e-010
Cycle   35  Error    7.955202  Scale 5.820766e-011
Cycle   36  Error    7.955201  Scale 2.910383e-011
Cycle   37  Error    7.955159  Scale 1.455192e-011
Cycle   38  Error    7.955156  Scale 7.275958e-012
Cycle   39  Error    7.955151  Scale 3.637979e-012
Cycle   40  Error    7.955151  Scale 1.818989e-012
Cycle   41  Error    7.955151  Scale 9.094947e-013
Cycle   42  Error    7.955084  Scale 4.547474e-013
Cycle   43  Error    7.954912  Scale 2.273737e-013
Cycle   44  Error    7.954910  Scale 1.136868e-013
Cycle   45  Error    7.954846  Scale 5.684342e-014
Cycle   46  Error    7.954828  Scale 2.842171e-014
Cycle   47  Error    7.954556  Scale 1.421085e-014
Cycle   48  Error    7.954555  Scale 7.105427e-015
Cycle   49  Error    7.954555  Scale 3.552714e-015
Cycle   50  Error    7.954554  Scale 1.776357e-015
Cycle   51  Error    7.954554  Scale 1.000000e-015
Cycle   52  Error    7.954553  Scale 1.000000e-015
Cycle   53  Error    7.954540  Scale 1.000000e-015
Cycle   54  Error    7.954540  Scale 1.000000e-015
Cycle   55  Error    7.954531  Scale 1.000000e-015
Cycle   56  Error    7.954522  Scale 1.000000e-015
Cycle   57  Error    7.954521  Scale 1.000000e-015
Cycle   58  Error    7.954521  Scale 1.000000e-015
Cycle   59  Error    7.954521  Scale 1.000000e-015
Cycle   60  Error    7.954521  Scale 1.000000e-015
Cycle   61  Error    7.954521  Scale 1.000000e-015
Cycle   62  Error    7.954521  Scale 1.000000e-015
Cycle   63  Error    7.954516  Scale 1.000000e-015
Cycle   64  Error    7.954516  Scale 1.000000e-015
Cycle   65  Error    7.954516  Scale 1.000000e-015
Cycle   66  Error    7.954514  Scale 1.000000e-015
Cycle   67  Error    7.954513  Scale 1.000000e-015
Cycle   68  Error    7.954513  Scale 1.000000e-015
Cycle   69  Error    7.954513  Scale 1.000000e-015
Cycle   70  Error    7.954513  Scale 1.000000e-015
Cycle   71  Error    7.954513  Scale 1.000000e-015
Cycle   72  Error    7.954513  Scale 1.000000e-015
Cycle   73  Error    7.954512  Scale 1.000000e-015
Cycle   74  Error    7.954512  Scale 1.000000e-015
Cycle   75  Error    7.954511  Scale 1.000000e-015
Cycle   76  Error    7.954511  Scale 1.000000e-015
Cycle   77  Error    7.954511  Scale 1.000000e-015
Cycle   78  Error    7.954510  Scale 1.000000e-015
Cycle   79  Error    7.954510  Scale 1.000000e-015
Cycle   80  Error    7.954509  Scale 1.000000e-015
Cycle   81  Error    7.954509  Scale 1.000000e-015
Cycle   82  Error    7.954509  Scale 1.000000e-015
Cycle   83  Error    7.954509  Scale 1.000000e-015
Cycle   84  Error    7.954509  Scale 1.000000e-015
Cycle   85  Error    7.954509  Scale 1.000000e-015
Cycle   86  Error    7.954509  Scale 1.000000e-015
Cycle   87  Error    7.954509  Scale 1.000000e-015
Cycle   88  Error    7.954509  Scale 1.000000e-015
Cycle   89  Error    7.954509  Scale 1.000000e-015
Cycle   90  Error    7.954509  Scale 1.000000e-015
Cycle   91  Error    7.954509  Scale 1.000000e-015
Cycle   92  Error    7.954509  Scale 1.000000e-015
Cycle   93  Error    7.954509  Scale 1.000000e-015
Cycle   94  Error    7.954509  Scale 1.000000e-015
Cycle   95  Error    7.954509  Scale 1.000000e-015
Cycle   96  Error    7.954509  Scale 1.000000e-015
Cycle   97  Error    7.954509  Scale 1.000000e-015
Cycle   98  Error    7.954509  Scale 1.000000e-015
Cycle   99  Error    7.954509  Scale 1.000000e-015
Cycle  100  Error    7.954509  Scale 1.000000e-015
Cycle  101  Error    7.954509  Scale 1.000000e-015
Cycle  102  Error    7.954509  Scale 1.000000e-015
Cycle  103  Error    7.954509  Scale 1.000000e-015
Cycle  104  Error    7.954509  Scale 1.000000e-015

Re-estimation cycle 3:
  alpha =   0.18015
  beta  =  66.98747
  gamma =   5.85619

 
true beta: 100.000000
 
Network training and hyperparameter re-estimation are now complete.
Compare the final value for the hyperparameter beta with the true
value.
 
Notice that the final error value is close to the number of data
points (16) divided by two.
 
We can now plot the function represented by the trained network. This
corresponds to the mean of the predictive distribution. We can also
plot 'error bars' representing one standard deviation of the
predictive distribution around the mean.
 
 
Notice how the confidence interval spanned by the 'error bars' is
smaller in the region of input space where the data density is high,
and becomes larger in regions away from the data.
 
Finished step -299  Threshold: 55.3956
  Sample rejected -298.  Threshold: 0.0639098
  Sample rejected -297.  Threshold: 0.0239409
  Sample rejected -296.  Threshold: 0.0682292
Finished step -295  Threshold: 0.0976515
Finished step -294  Threshold: 48.6535
  Sample rejected -293.  Threshold: 0.751146
  Sample rejected -292.  Threshold: 0.0501606
Finished step -291  Threshold: 0.481617
Finished step -290  Threshold: 0.437238
Finished step -289  Threshold: 5.65225
Finished step -288  Threshold: 1.8901
  Sample rejected -287.  Threshold: 0.575624
  Sample rejected -286.  Threshold: 0.500956
  Sample rejected -285.  Threshold: 0.360815
Finished step -284  Threshold: 0.702825
  Sample rejected -283.  Threshold: 0.321342
Finished step -282  Threshold: 1.51216
Finished step -281  Threshold: 1.12391
Finished step -280  Threshold: 0.879402
  Sample rejected -279.  Threshold: 0.512558
Finished step -278  Threshold: 1.29523
Finished step -277  Threshold: 0.888943
  Sample rejected -276.  Threshold: 0.567576
Finished step -275  Threshold: 1.17879
Finished step -274  Threshold: 0.976295
Finished step -273  Threshold: 0.619447
Finished step -272  Threshold: 0.729504
Finished step -271  Threshold: 1.13317
Finished step -270  Threshold: 1.1206
Finished step -269  Threshold: 0.843392
Finished step -268  Threshold: 0.977255
Finished step -267  Threshold: 1.20852
Finished step -266  Threshold: 1.29944
Finished step -265  Threshold: 1.39464
Finished step -264  Threshold: 1.11921
Finished step -263  Threshold: 0.899153
Finished step -262  Threshold: 1.06386
Finished step -261  Threshold: 0.876192
Finished step -260  Threshold: 0.832054
Finished step -259  Threshold: 0.990181
Finished step -258  Threshold: 1.00075
Finished step -257  Threshold: 0.946959
Finished step -256  Threshold: 1.00503
Finished step -255  Threshold: 1.0878
Finished step -254  Threshold: 0.831716
Finished step -253  Threshold: 1.00278
Finished step -252  Threshold: 0.989569
Finished step -251  Threshold: 1.15461
Finished step -250  Threshold: 1.00303
Finished step -249  Threshold: 1.02801
Finished step -248  Threshold: 1.16495
Finished step -247  Threshold: 0.971279
Finished step -246  Threshold: 1.00374
Finished step -245  Threshold: 1.03962
Finished step -244  Threshold: 0.943031
Finished step -243  Threshold: 1.03798
Finished step -242  Threshold: 0.936567
Finished step -241  Threshold: 0.946993
Finished step -240  Threshold: 0.971833
Finished step -239  Threshold: 0.996069
Finished step -238  Threshold: 1.00672
Finished step -237  Threshold: 1.01145
Finished step -236  Threshold: 1.0165
Finished step -235  Threshold: 0.906025
Finished step -234  Threshold: 1.01499
Finished step -233  Threshold: 1.11363
Finished step -232  Threshold: 0.970929
Finished step -231  Threshold: 1.01135
Finished step -230  Threshold: 0.996634
Finished step -229  Threshold: 0.996934
Finished step -228  Threshold: 1.00156
Finished step -227  Threshold: 1.06389
Finished step -226  Threshold: 0.983708
  Sample rejected -225.  Threshold: 0.846918
Finished step -224  Threshold: 1.13129
Finished step -223  Threshold: 0.98852
Finished step -222  Threshold: 0.938764
Finished step -221  Threshold: 1.13822
Finished step -220  Threshold: 1.00793
Finished step -219  Threshold: 0.972013
Finished step -218  Threshold: 1.06629
Finished step -217  Threshold: 0.983042
Finished step -216  Threshold: 1.01379
Finished step -215  Threshold: 0.997635
Finished step -214  Threshold: 0.982777
Finished step -213  Threshold: 0.973046
Finished step -212  Threshold: 1.04562
Finished step -211  Threshold: 1.00387
Finished step -210  Threshold: 0.983636
Finished step -209  Threshold: 0.987806
Finished step -208  Threshold: 0.989133
Finished step -207  Threshold: 0.997975
Finished step -206  Threshold: 0.99243
Finished step -205  Threshold: 1.02231
Finished step -204  Threshold: 1.02261
Finished step -203  Threshold: 0.998456
Finished step -202  Threshold: 1.00573
Finished step -201  Threshold: 1.00504
Finished step -200  Threshold: 1.00359
Finished step -199  Threshold: 0.997886
Finished step -198  Threshold: 0.996484
Finished step -197  Threshold: 1.00009
Finished step -196  Threshold: 0.996435
Finished step -195  Threshold: 0.992874
Finished step -194  Threshold: 1.008
Finished step -193  Threshold: 0.993222
Finished step -192  Threshold: 0.98656
Finished step -191  Threshold: 1.00232
Finished step -190  Threshold: 1.0035
Finished step -189  Threshold: 0.997049
Finished step -188  Threshold: 0.999491
Finished step -187  Threshold: 1.00035
Finished step -186  Threshold: 1.00566
Finished step -185  Threshold: 1.01444
Finished step -184  Threshold: 1.00743
Finished step -183  Threshold: 1.00011
Finished step -182  Threshold: 0.992539
Finished step -181  Threshold: 0.993485
Finished step -180  Threshold: 1.00219
Finished step -179  Threshold: 0.995585
Finished step -178  Threshold: 0.999746
Finished step -177  Threshold: 0.998732
Finished step -176  Threshold: 1.0001
Finished step -175  Threshold: 1.00123
Finished step -174  Threshold: 1.01666
Finished step -173  Threshold: 0.999768
Finished step -172  Threshold: 1.00064
Finished step -171  Threshold: 0.999044
Finished step -170  Threshold: 1.00564
Finished step -169  Threshold: 0.991961
Finished step -168  Threshold: 0.999893
Finished step -167  Threshold: 1.00327
Finished step -166  Threshold: 0.992282
Finished step -165  Threshold: 0.991321
Finished step -164  Threshold: 0.996746
Finished step -163  Threshold: 1.00124
Finished step -162  Threshold: 1.01096
Finished step -161  Threshold: 0.999045
Finished step -160  Threshold: 1.00544
Finished step -159  Threshold: 1.00427
Finished step -158  Threshold: 1.00007
Finished step -157  Threshold: 0.992235
Finished step -156  Threshold: 0.99377
Finished step -155  Threshold: 0.999713
Finished step -154  Threshold: 1.00191
Finished step -153  Threshold: 1.01021
Finished step -152  Threshold: 1.00287
Finished step -151  Threshold: 0.995246
Finished step -150  Threshold: 1.00473
Finished step -149  Threshold: 0.997966
Finished step -148  Threshold: 0.994584
Finished step -147  Threshold: 0.995856
Finished step -146  Threshold: 0.996325
Finished step -145  Threshold: 1.00612
Finished step -144  Threshold: 1.00858
Finished step -143  Threshold: 0.992262
Finished step -142  Threshold: 1.00647
Finished step -141  Threshold: 0.991492
Finished step -140  Threshold: 1.00906
Finished step -139  Threshold: 1.00063
Finished step -138  Threshold: 0.999596
Finished step -137  Threshold: 0.997668
Finished step -136  Threshold: 1.00274
Finished step -135  Threshold: 0.997799
Finished step -134  Threshold: 1.00426
Finished step -133  Threshold: 0.999671
Finished step -132  Threshold: 0.991936
Finished step -131  Threshold: 0.998259
Finished step -130  Threshold: 0.996403
Finished step -129  Threshold: 0.997971
Finished step -128  Threshold: 0.988864
Finished step -127  Threshold: 1.001
Finished step -126  Threshold: 0.998546
Finished step -125  Threshold: 1.01615
Finished step -124  Threshold: 0.991328
Finished step -123  Threshold: 1.01048
Finished step -122  Threshold: 0.999272
Finished step -121  Threshold: 1.00219
Finished step -120  Threshold: 0.999387
Finished step -119  Threshold: 1.00176
Finished step -118  Threshold: 0.999385
Finished step -117  Threshold: 0.997645
Finished step -116  Threshold: 0.985035
Finished step -115  Threshold: 0.996507
Finished step -114  Threshold: 1.00312
Finished step -113  Threshold: 0.998432
Finished step -112  Threshold: 0.998306
Finished step -111  Threshold: 1.00241
Finished step -110  Threshold: 1.00817
Finished step -109  Threshold: 0.998991
Finished step -108  Threshold: 1.00787
Finished step -107  Threshold: 0.997258
Finished step -106  Threshold: 1.00746
Finished step -105  Threshold: 0.984775
Finished step -104  Threshold: 0.994548
Finished step -103  Threshold: 0.986582
Finished step -102  Threshold: 1.01347
Finished step -101  Threshold: 1.046
Finished step -100  Threshold: 0.99973
Finished step  -99  Threshold: 0.981183
Finished step  -98  Threshold: 0.998386
Finished step  -97  Threshold: 0.997147
Finished step  -96  Threshold: 1.0031
Finished step  -95  Threshold: 1.01602
Finished step  -94  Threshold: 1.00697
Finished step  -93  Threshold: 0.981262
Finished step  -92  Threshold: 0.986818
Finished step  -91  Threshold: 0.998685
Finished step  -90  Threshold: 0.999369
Finished step  -89  Threshold: 1.00262
Finished step  -88  Threshold: 0.990391
Finished step  -87  Threshold: 1.00094
Finished step  -86  Threshold: 0.995389
Finished step  -85  Threshold: 1.00618
Finished step  -84  Threshold: 1.00052
Finished step  -83  Threshold: 1.0002
Finished step  -82  Threshold: 1.00797
Finished step  -81  Threshold: 1.00684
Finished step  -80  Threshold: 0.998114
Finished step  -79  Threshold: 0.999873
Finished step  -78  Threshold: 1.00048
Finished step  -77  Threshold: 0.99948
Finished step  -76  Threshold: 1.0014
Finished step  -75  Threshold: 0.999358
Finished step  -74  Threshold: 0.990169
Finished step  -73  Threshold: 0.991842
Finished step  -72  Threshold: 0.998221
Finished step  -71  Threshold: 1.00028
Finished step  -70  Threshold: 1.00352
Finished step  -69  Threshold: 1.00503
Finished step  -68  Threshold: 1.00448
Finished step  -67  Threshold: 1.00242
Finished step  -66  Threshold: 1.00578
Finished step  -65  Threshold: 0.998793
Finished step  -64  Threshold: 1.00423
Finished step  -63  Threshold: 1.00199
Finished step  -62  Threshold: 0.985885
Finished step  -61  Threshold: 0.993577
Finished step  -60  Threshold: 0.990027
Finished step  -59  Threshold: 1.00354
  Sample rejected  -58.  Threshold: 0.991046
Finished step  -57  Threshold: 1.01222
Finished step  -56  Threshold: 0.996855
Finished step  -55  Threshold: 0.988037
Finished step  -54  Threshold: 1.00092
Finished step  -53  Threshold: 1.00535
Finished step  -52  Threshold: 1.01375
Finished step  -51  Threshold: 1.00961
Finished step  -50  Threshold: 0.998072
Finished step  -49  Threshold: 1.00098
Finished step  -48  Threshold: 0.99445
Finished step  -47  Threshold: 1.00402
Finished step  -46  Threshold: 1.00864
  Sample rejected  -45.  Threshold: 0.996309
Finished step  -44  Threshold: 0.970314
Finished step  -43  Threshold: 0.992624
Finished step  -42  Threshold: 1.00723
Finished step  -41  Threshold: 0.997597
Finished step  -40  Threshold: 1.00691
Finished step  -39  Threshold: 0.993005
Finished step  -38  Threshold: 0.983167
Finished step  -37  Threshold: 1.01414
Finished step  -36  Threshold: 0.973991
Finished step  -35  Threshold: 1.01485
Finished step  -34  Threshold: 0.98922
Finished step  -33  Threshold: 0.999824
Finished step  -32  Threshold: 1.00303
Finished step  -31  Threshold: 0.998644
Finished step  -30  Threshold: 1.00332
Finished step  -29  Threshold: 1.00316
Finished step  -28  Threshold: 1.0083
Finished step  -27  Threshold: 0.996184
Finished step  -26  Threshold: 1.00627
Finished step  -25  Threshold: 1.01515
Finished step  -24  Threshold: 1.01028
Finished step  -23  Threshold: 0.999156
Finished step  -22  Threshold: 0.995917
Finished step  -21  Threshold: 0.998304
Finished step  -20  Threshold: 0.992438
Finished step  -19  Threshold: 0.999957
Finished step  -18  Threshold: 1.01234
Finished step  -17  Threshold: 1.00366
Finished step  -16  Threshold: 0.999675
Finished step  -15  Threshold: 0.998282
Finished step  -14  Threshold: 1.001
Finished step  -13  Threshold: 0.998249
Finished step  -12  Threshold: 0.999293
Finished step  -11  Threshold: 0.997866
Finished step  -10  Threshold: 1.00106
Finished step   -9  Threshold: 1.00136
Finished step   -8  Threshold: 0.995676
Finished step   -7  Threshold: 1.00033
Finished step   -6  Threshold: 1.01202
Finished step   -5  Threshold: 0.997695
Finished step   -4  Threshold: 0.999811
Finished step   -3  Threshold: 1.00026
Finished step   -2  Threshold: 1.0006
Finished step   -1  Threshold: 0.986391
Finished step    0  Threshold: 1.00014
Finished step    1  Threshold: 1.00043
Finished step    2  Threshold: 1.00584
Finished step    3  Threshold: 1.00043
Finished step    4  Threshold: 1.00093
Finished step    5  Threshold: 1.00388
Finished step    6  Threshold: 1.00078
Finished step    7  Threshold: 1.00007
Finished step    8  Threshold: 1.00012
Finished step    9  Threshold: 0.999964
Finished step   10  Threshold: 1.00005
Finished step   11  Threshold: 0.998607
Finished step   12  Threshold: 1.00229
Finished step   13  Threshold: 0.999285
Finished step   14  Threshold: 0.999792
Finished step   15  Threshold: 1.00041
Finished step   16  Threshold: 0.998652
Finished step   17  Threshold: 1.002
Finished step   18  Threshold: 0.999254
Finished step   19  Threshold: 0.998627
Finished step   20  Threshold: 0.996755
Finished step   21  Threshold: 0.999829
Finished step   22  Threshold: 1.00149
Finished step   23  Threshold: 1.00632
Finished step   24  Threshold: 1.00128
Finished step   25  Threshold: 1.00011
Finished step   26  Threshold: 0.999019
Finished step   27  Threshold: 1.00018
Finished step   28  Threshold: 0.999802
Finished step   29  Threshold: 0.998938
Finished step   30  Threshold: 1.00052
Finished step   31  Threshold: 1.00001
Finished step   32  Threshold: 1.0003
Finished step   33  Threshold: 1.00002
Finished step   34  Threshold: 1.00031
Finished step   35  Threshold: 1.0004
Finished step   36  Threshold: 1.00001
Finished step   37  Threshold: 0.999686
Finished step   38  Threshold: 1.00039
Finished step   39  Threshold: 0.998419
Finished step   40  Threshold: 1.00099
Finished step   41  Threshold: 1.00003
Finished step   42  Threshold: 0.999916
Finished step   43  Threshold: 0.993685
Finished step   44  Threshold: 0.991881
Finished step   45  Threshold: 0.99891
Finished step   46  Threshold: 0.995033
Finished step   47  Threshold: 0.987324
Finished step   48  Threshold: 1.0006
Finished step   49  Threshold: 0.999464
Finished step   50  Threshold: 0.999973
Finished step   51  Threshold: 1.00097
Finished step   52  Threshold: 0.999882
Finished step   53  Threshold: 1.00008
Finished step   54  Threshold: 1.00137
Finished step   55  Threshold: 1.00179
Finished step   56  Threshold: 0.994908
Finished step   57  Threshold: 0.99535
Finished step   58  Threshold: 0.998891
Finished step   59  Threshold: 0.998489
Finished step   60  Threshold: 1.00426
Finished step   61  Threshold: 1.00836
Finished step   62  Threshold: 1.00041
Finished step   63  Threshold: 1.00495
Finished step   64  Threshold: 1.00147
Finished step   65  Threshold: 0.9896
Finished step   66  Threshold: 0.985075
Finished step   67  Threshold: 0.993836
Finished step   68  Threshold: 1.00656
Finished step   69  Threshold: 0.993091
Finished step   70  Threshold: 0.999027
Finished step   71  Threshold: 1.01571
Finished step   72  Threshold: 1.01919
Finished step   73  Threshold: 1.00079
Finished step   74  Threshold: 1.0006
Finished step   75  Threshold: 1.00002
Finished step   76  Threshold: 0.999057
Finished step   77  Threshold: 1.00077
Finished step   78  Threshold: 1
Finished step   79  Threshold: 0.999946
Finished step   80  Threshold: 1.00009
Finished step   81  Threshold: 0.999657
Finished step   82  Threshold: 1.00017
Finished step   83  Threshold: 0.996175
Finished step   84  Threshold: 0.999439
Finished step   85  Threshold: 0.996495
Finished step   86  Threshold: 0.997904
Finished step   87  Threshold: 1.02057
Finished step   88  Threshold: 1.00105
Finished step   89  Threshold: 0.976888
Finished step   90  Threshold: 1.00156
Finished step   91  Threshold: 1.00207
Finished step   92  Threshold: 1.00008
Finished step   93  Threshold: 0.995746
Finished step   94  Threshold: 0.9999
Finished step   95  Threshold: 1.00049
Finished step   96  Threshold: 0.999679
Finished step   97  Threshold: 0.999665
Finished step   98  Threshold: 1.00014
Finished step   99  Threshold: 1.00832
Finished step  100  Threshold: 0.999212

Fraction of samples rejected:  0
The plot shows the underlying noise free function, the 100 samples
produced from the MLP, and their average as a Monte Carlo estimate
of the true posterior average.
 
Note how the predictions become much further from the true function
away from the region of high data density.
</pre><img vspace="5" hspace="5" src="mlpRegHmcDemo_01.png" alt=""> <img vspace="5" hspace="5" src="mlpRegHmcDemo_02.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.9<br></p></div><!--
##### SOURCE BEGIN #####
% Based on Netlan's DEMHMC3
% We modified the code so the model is as similar as possible
% to the one in demev1, so we can compare MCMC with Laplace approx

% create the data and do EB on the network
mlpRegEvidenceDemo;


% use the EB hyper-params
alpha = net.alpha;
beta = net.beta;

% Create and initialize fresh network model.

% Initialise weights reasonably close to 0
net = mlp(nin, nhidden, nout, 'linear', alpha, beta);
net = mlpinit(net, 10);


% Set up vector of options for hybrid Monte Carlo.
nsamples = 100;		% Number of retained samples.

options = foptions;     % Default options vector.
options(1) = 1;		% Switch on diagnostics.
options(5) = 1;		% Use persistence
options(7) = 10;	% Number of steps in trajectory.
options(14) = nsamples;	% Number of Monte Carlo samples returned. 
options(15) = 300;	% Number of samples omitted at start of chain.
options(17) = 0.95;	% Alpha value in persistence
options(18) = 0.005;	% Step size.

w = mlppak(net);
% Initialise HMC
hmc('state', 42);
[samples, energies] = hmc('neterr', w, options, 'netgrad', net, x, t);


disp('The plot shows the underlying noise free function, the 100 samples')
disp('produced from the MLP, and their average as a Monte Carlo estimate')
disp('of the true posterior average.')
disp(' ')


nplot = 300;
plotvals = [0 : 1/(nplot - 1) : 1]';
pred = zeros(size(plotvals));
fh1 = figure;
hold on
for k = 1:nsamples
  w2 = samples(k,:);
  net2 = mlpunpak(net, w2);
  y = mlpfwd(net2, plotvals);
  % Sum predictions
  pred = pred + y;
  h4 = plot(plotvals, y, ':b', 'LineWidth', 1);
end
pred = pred./nsamples;

% Plot data
h1 = plot(x, t, 'ok', 'LineWidth', 2);
%axis([0 1 -3 3])
axis([0 1 -1.5 1.5])

% Plot function
[fx, fy] = fplot('sin(2*pi*x)', [0 1], 'REPLACE_WITH_DASH_DASHg');
h2 = plot(fx, fy, 'REPLACE_WITH_DASH_DASHg', 'LineWidth', 2);
set(gca, 'box', 'on');

% Plot averaged prediction
h3 = plot(plotvals, pred, '-r', 'LineWidth', 3);

lstrings = char('Data', 'Function', 'Prediction', 'Samples');
legend([h1 h2 h3 h4], lstrings, 3);
hold off

disp('Note how the predictions become much further from the true function')
disp('away from the region of high data density.')

printPmtkFigure('mlpRegHmc')

##### SOURCE END #####
--></body></html>